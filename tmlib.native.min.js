tm.native=tm.native||{},tm.native.isNative=function(){/piyokawa/i.test(navigator.userAgent);return function(){}}(),function(){var a="piyo://",b=document.createElement("iframe");b.style.display="none",window.addEventListener("DOMContentLoaded",function(){document.body.appendChild(b)});var c=[];setInterval(function(){if(0!=c.length){var a=c.shift();tm.native.isNative()?b.contentWindow.location=a:console.log(a)}},50),tm.native.api={exec:function(b){c.push(a+b)},closeView:function(){this.exec("closeView")},playSound:function(a,b){b=b||{},b.name=a,b.callback=this.setCallbackFunction(b.callback),this.exec("playSound?"+tm.util.QueryString.stringify(b))},stopSound:function(){this.exec("stopSound")},playMusic:function(a,b){b=b||{},b.name=a,b.callback=this.setCallbackFunction(b.callback),this.exec("playMusic?"+tm.util.QueryString.stringify(b))},stopMusic:function(){this.exec("stopMusic")},sendScore:function(a,b,c){if(tm.native.isNative()){var d={id:a,score:b,callback:c};d.callback=this.setCallbackFunction(d.callback),this.exec("sendScore?"+tm.util.QueryString.stringify(d))}else c&&c()},getRanking:function(a,b){if(tm.native.isNative()){var c={id:a,callback:b};c.callback=this.setCallbackFunction(c.callback),this.exec("getSelfRanking?"+tm.util.QueryString.stringify(c))}else b&&b(512)},viewRanking:function(a){var b={id:a};this.exec("viewRanking?"+tm.util.QueryString.stringify(b))},sendTwitter:function(a){if(a.text=a.text||"",a.via=a.via||"",a.hashtags=a.hashtags||"",a.hashtags){var b=a.hashtags.split(","),c=[];b.each(function(a){c.push("#"+a)}),a.hashtags=c.join(" ")}else a.hashtags="";var d="{text} via @{via} {hashtags}".format(a),e={text:d,url:a.url||""};this.exec("twitter?"+tm.util.QueryString.stringify(e))},sendFacebook:function(a){a.text=a.text||"",a.url=a.url||"",this.exec("facebook?"+tm.util.QueryString.stringify(a))},sendLine:function(a){a.text=a.text||"",a.url=a.url||"",this.exec("line?"+tm.util.QueryString.stringify(a))},getLanguage:function(a){if(tm.native.isNative()){a=this.setCallbackFunction(a);var b={callback:a};this.exec("getLanguage?"+tm.util.QueryString.stringify(b))}else a&&a("en")},setCallbackFunction:function(a){if(!a)return null;window._nativeTempFuncCount=window._nativeTempFuncCount||0;var b="_nativeTempFunc"+window._nativeTempFuncCount++;return window[b]=a,b}}}(),function(){if(tm.native.isNative()){var a=function(a){return NativeAudio(a)};tm.asset.Loader.register("wav",a),tm.asset.Loader.register("mp3",a),tm.asset.Loader.register("m4a",a),tm.asset.Loader.register("ogg",a),tm.define("NativeAudio",{superClass:"tm.event.EventDispatcher",src:"",loaded:!1,loopFlag:!1,volume:.8,init:function(a){this.superInit(),this.loaded=!0,this._load(a)},_load:function(a){var b=a.match(/(.*)$/);return this.src=a,this.path=b[1].replace("sounds/",""),this.volume=.8,this.loaded=!0,this.fire(tm.event.Event("load")),this},play:function(){var a=this;return 0==this.loopFlag?yyjtk.api.playSound(this.path,{volume:this.volume,callback:function(){var b=tm.event.Event("ended");a.fire(b)}}):yyjtk.api.playMusic(this.path,{volume:this.volume,callback:function(){var b=tm.event.Event("ended");a.fire(b)}}),this},stop:function(){return 0==this.loopFlag?yyjtk.api.stopSound():yyjtk.api.stopMusic(),this},setLoop:function(a){return this.loopFlag=a,this},setVolume:function(a){return this.volume=a,this},clone:function(){var a=NativeAudio(this.src);return a}})}}();