tm["native"]=tm["native"]||{},tm["native"].isNative=function(){var t=/tmlib/i.test(navigator.userAgent);return function(){return t}}(),function(){var t="tmlib",e=document.createElement("iframe");e.style.display="none",window.addEventListener("DOMContentLoaded",function(){document.body.appendChild(e)});var i=[],a={},n=0;tm["native"].api={loop:function(){if(0!=i.length){var t=i.shift();if(tm["native"].isNative()){var a=tm["native"].api.toScheme(t.method,t.param);e.contentWindow.location=a,console.log(a)}else t.param.callback&&t.param.callback({request:t})}},exec:function(t,e){return i.push({method:t,param:e}),this},toScheme:function(e,i){if(i){i.callback?i.callback=this.setCallback(i.callback):delete i.callback;var a=tm.util.QueryString.stringify(i),n="{0}://{1}?{2}".format(t,e,a)}else var n="{0}://{1}".format(t,e);return n},closeView:function(){this.exec("closeView")},playSound:function(t,e){e=e||{},e.name=t,e.callback=this.setCallback(e.callback),this.exec("playSound?"+tm.util.QueryString.stringify(e))},stopSound:function(){this.exec("stopSound")},playMusic:function(t,e){e=e||{},e.name=t,e.callback=this.setCallback(e.callback),this.exec("playMusic?"+tm.util.QueryString.stringify(e))},stopMusic:function(){this.exec("stopMusic")},sendScore:function(t,e,i){if(tm["native"].isNative()){var a={id:t,score:e,callback:i};a.callback=this.setCallback(a.callback),this.exec("sendScore?"+tm.util.QueryString.stringify(a))}else i&&i()},getRanking:function(t,e){if(tm["native"].isNative()){var i={id:t,callback:e};i.callback=this.setCallback(i.callback),this.exec("getSelfRanking?"+tm.util.QueryString.stringify(i))}else e&&e(512)},viewRanking:function(t){var e={id:t};this.exec("viewRanking?"+tm.util.QueryString.stringify(e))},sendTwitter:function(t){if(t.text=t.text||"",t.via=t.via||"",t.hashtags=t.hashtags||"",t.hashtags){var e=t.hashtags.split(","),i=[];e.each(function(t){i.push("#"+t)}),t.hashtags=i.join(" ")}else t.hashtags="";var a="{text} via @{via} {hashtags}".format(t),n={text:a,url:t.url||""};this.exec("twitter?"+tm.util.QueryString.stringify(n))},sendFacebook:function(t){t.text=t.text||"",t.url=t.url||"",this.exec("facebook?"+tm.util.QueryString.stringify(t))},sendLine:function(t){t.text=t.text||"",t.url=t.url||"",this.exec("line?"+tm.util.QueryString.stringify(t))},getLanguage:function(t){if(tm["native"].isNative()){t=this.setCallback(t);var e={callback:t};this.exec("getLanguage?"+tm.util.QueryString.stringify(e))}else t&&t("en")},setCallback:function(t){if(!t)return null;var e="index"+n++;return a[e]=t,e},execCallback:function(t,e){return a[t](e),this},deleteCallback:function(t){return delete a[t],this}},setInterval(tm["native"].api.loop,50)}(),function(){tm["native"].gamekit={authenticate:function(t){return tm["native"].api.exec("authenticate",{callback:t}),this},sendScore:function(t,e,i){return tm["native"].api.exec("sendScore",{id:t,score:e,callback:i}),this},showRanking:function(t,e){return tm["native"].api.exec("showRanking",{id:t,callback:e}),this}}}(),function(){if(tm["native"].isNative()){var t=function(t){return NativeAudio(t)};tm.asset.Loader.register("wav",t),tm.asset.Loader.register("mp3",t),tm.asset.Loader.register("m4a",t),tm.asset.Loader.register("ogg",t),tm.define("NativeAudio",{superClass:"tm.event.EventDispatcher",src:"",loaded:!1,loopFlag:!1,volume:.8,init:function(t){this.superInit(),this.loaded=!0,this._load(t)},_load:function(t){var e=t.match(/(.*)$/);return this.src=t,this.path=e[1].replace("sounds/",""),this.volume=.8,this.loaded=!0,this.fire(tm.event.Event("load")),this},play:function(){var t=this;return 0==this.loopFlag?yyjtk.api.playSound(this.path,{volume:this.volume,callback:function(){var e=tm.event.Event("ended");t.fire(e)}}):yyjtk.api.playMusic(this.path,{volume:this.volume,callback:function(){var e=tm.event.Event("ended");t.fire(e)}}),this},stop:function(){return 0==this.loopFlag?yyjtk.api.stopSound():yyjtk.api.stopMusic(),this},setLoop:function(t){return this.loopFlag=t,this},setVolume:function(t){return this.volume=t,this},clone:function(){var t=NativeAudio(this.src);return t}})}}();